{% extends 'Front/base/main.html.twig' %}

{% block titleHeader %}
Ver cliente
{% endblock %}
{% block content %}

<link rel="stylesheet" href="/css/css_all/bills/preBills.css">
<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.1.0-rc.0/css/select2.min.css" rel="stylesheet" />

<style>
    .form-control {
        display: block;
        width: 100%;
        padding: 0.35rem 0.75rem;
        font-size: 1rem;
        font-weight: 400;
        line-height: 1.5;
        color: #212529;
        background-color: #fff;
        background-clip: padding-box;
        border: 1px solid #587ffc;
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
        border-radius: 20px;
        transition: border-color .15s ease-in-out, box-shadow .15s ease-in-out;
    }

    .btn-close {

        background: transparent url(data:image/svg+xml, %3csvg xmlns='http://www.w3.org / 2000/svg' viewBox='0 0 16 16' fill='%23fff'%3e%3cpath d='M.293.293a1 1 0 011.414 0L8 6.586 14.293.293a1 1 0 111.414 1.414L9.414 8l6.293 6.293a1 1 0 01-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 01-1.414-1.414L6.586 8 .293 1.707a1 1 0 010-1.414z'/%3e%3c/svg%3e) center/1em auto no-repeat !important;

    }

    .modal-content {

        position: relative;
        display: flex;
        flex-direction: column;
        width: 100%;
        pointer-events: auto;
        background-color: transparent !important;
        background-clip: padding-box;
        border: 1px solid rgba(0, 0, 0, .2);
        border-radius: 0.3rem;
        outline: 0;
    }
</style>

<div id="miVentanaModal" class="">

    <div class=" contenedorBills p-3 ">

        <div class="col-12  contenedor p-3 ">

            {# {% include 'Front/base/error.html.twig' %} #}

            <div class="row ">

                <div class="col-sm-4 pre_div_info">

                    <span class="pre_text_customers mt-2">
                        <b>
                            TOT PER CONSTRUIR 2012, S.L.</b>
                    </span><br>

                    <span class="pre_text_customers">
                        C.I.F.: DB-98474497 NIMA:
                    </span><br>

                    <span class="pre_text_customers">Dirección: Calle Rio Guadalaviar, 6. Quart de Poblet
                        (Valencia)</span><br>

                    <span class="pre_text_customers">
                        CP: 46930 – Teléfono: 961391755 – 656414748</span><br>

                    <span class="pre_text_customers">Correo electrónico: gestion@tpc2012.es Página web:
                        www.tpc2012.es
                    </span>
                    <br>

                </div>

                <div class="col-sm-4  text-center">

                    <img src="\images\logo\logos_facturas_2.png" width="180" height="60" alt="logo" class="mt-2"><br>

                </div>

                <div class="col-sm-4 pre_div_info">

                    . Recogida y transporte de residuos no peligrosos<br>
                    · Recogida y destruccion de documentacion confidencial<br>
                    · Alquiler de maquinaria de obra publica con conductor especializado<br>
                    · Suministro y transporte de aridos en camion de gran tonelaje<br>

                </div>
            </div>

            {% for customer in customers %}
            <div class="row">

                <div class="col-sm-4 pre_div_info">

                    <span class="text_adress">
                        <em>
                            Direccion de Fiscal</em>
                    </span>
                    <br>

                    <span class="pre_text_customers mt-2">
                        <b>{{ customer.names|upper }}</b>
                    </span><br>

                    <span class="pre_text_customers">
                        {{ customer.dni }}
                    </span><br>

                    <span class="pre_text_customers">Dirección:
                        {{ customer.address }},
                        {{ customer.location }},
                        {{ customer.province }}.
                    </span><br>

                    <span class="pre_text_customers">
                        CP:
                        {{ customer.zip_code }}, Teléfono:
                        {{ customer.phone }}</span><br>

                </div>

                <div class="col-sm-4  text-center"></div>

                <div class="col-sm-4 pre_div_info">

                    <span class="text_adress">
                        <em>
                            Direccion de Correspondencia</em>
                    </span><br>

                    <span class="pre_text_customers mt-2">
                        <b>{{ customer.names|upper }}</b>
                    </span><br>

                    <span class="pre_text_customers">
                        {{ customer.dni }}
                    </span><br>

                    <span class="pre_text_customers">Dirección:
                        {{ customer.address }},
                        {{ customer.location }},
                        {{ customer.province }}.
                    </span><br>

                    <span class="pre_text_customers">
                        CP:
                        {{ customer.zip_code }}, Teléfono:
                        {{ customer.phone }}</span><br>

                </div>
            </div>

            <div class="row p-0 justify-content-left">

                <div class="col-sm-4  p-0 col_text-title-factura">
                    <span class="text-title-factura p-1">Factura&nbsp;</span>

                </div>
            </div>

            <div class="row justify-content-center">

                <table class="table table-striped table-borderless tabla" style="font-size:0.8rem !important;">

                    <thead style="color:#4d8f24;">
                        <tr style="color:#4d8f24;margin:none !important; padding:none !important;">
                            <th scope="col" class=""
                                style="margin:none !important; padding:none !important; font-size:0.8rem !important;background:none !important;">
                                &nbsp;&nbsp;Fecha
                            </th>
                            <th scope="col" class="text-black"
                                style="margin:none !important; padding:none !important;font-size:0.8rem !important;background:none !important;padding:none !important;">
                                &nbsp;&nbsp;{{ date_today }}</th>

                            <th scope="col" class=""
                                style="margin:none !important; padding:none !important;font-size:0.8rem !important;background:none !important;">
                                &nbsp;&nbsp;Cliente</th>
                            <th scope="col" class="text-black"
                                style="margin:none !important; padding:none !important;font-size:0.8rem !important;background:none !important;">
                                &nbsp;&nbsp;{{ customer.id_customer }}</th>
                            <th scope="col" class=""
                                style="margin:none !important; padding:none !important;font-size:0.8rem !important;background:none !important;">
                                &nbsp;&nbsp; Teléfono/Fax</th>
                            <th scope="col" class="text-black"
                                style="margin:none !important; padding:none !important;font-size:0.8rem!important;background:none !important;">
                                &nbsp;&nbsp;{{ customer.phone }}</th>

                        </tr>
                    </thead>

                    <thead style="color:#4d8f24;">
                        <tr>
                            <th scope="col" class="" style="font-size:0.8rem !important;background:none !important;">
                                &nbsp;&nbsp;Numero
                            </th>

                            <th scope="col" class="" style="font-size:0.8rem !important;background:none !important;">(Se
                                genera al dar boton generar factura)
                            </th>

                            <th scope="col" class="" style="font-size:0.8rem !important;background:none !important;">
                                &nbsp;&nbsp;CIF/NIF</th>
                            <th scope="col" class="text-black"
                                style="font-size:0.8rem!important;background:none !important;">
                                &nbsp;&nbsp;{{ customer.dni }}</th>

                        </tr>
                    </thead>

                </table>

            </div>

            {% endfor %}

            <div class="row justify-content-center">

                <table class="table table-striped table-borderless tabla">

                    <thead style="background-color:#4d8f24;" class="text-white ">
                        <tr>
                            <th scope="col" class="text-center" style="font-size:0.8rem !important;">
                                &nbsp;&nbsp;&nbsp;&nbsp;Codigo
                            </th>
                            <th scope="col" class="text-center" style="font-size:0.8rem !important;">Cantidad</th>

                            <th scope="col" class="text-center" style="font-size:0.8rem !important;">Descripcion</th>
                            <th scope="col" class="text-center" style="font-size:0.8rem !important;">Precio</th>
                            <th scope="col" class="text-center" style="font-size:0.8rem !important;width:65px;">
                                % Dto.</th>
                            <th scope="col" class="text-center" style="font-size:0.8rem !important;">
                                Imp.Dto.</th>
                            <th scope="col" class="text-center" style="font-size:0.8rem !important;">Importe</th>

                        </tr>
                    </thead>

                    <tbody>

                        {#-----contendores------ #}
                        <tr>

                            {% for arraysIdsAlbarane in id_albaranes_selected %}
                            {% if ( arraysIdsAlbarane.active == 1 ) %}

                            <td scope="col" class=" text-center text-black"
                                style="border-bottom:1px solid #dfdfdf87 !important;font-size:0.8rem !important;background:none !important;">
                                {% for s in arraysIdsAlbarane %}
                                {{ s.service_code }}
                                {% endfor %}
                            </td>

                            <td scope="col" class=" text-center text-black"
                                style="border-bottom:1px solid #dfdfdf87 !important;font-size:0.8rem !important;background:none !important;">
                                1
                            </td>

                            <td scope="col" class=" text-center text-black"
                                style="border-bottom:1px solid #dfdfdf87 !important;font-size:0.8rem !important;background:none !important;">
                                <b>Servicio Nº(Albaran)
                                    {{ arraysIdsAlbarane.id_albaran }}
                                    de Fecha:
                                    {{ date_today }}</b>
                                <br>
                                {% for worklocation in worklocations %}
                                Obra:
                                {{ id_work_location }}
                                -
                                {{ worklocation.address }}
                                {{ worklocation.location }}

                                {% endfor %}
                                <br>
                                {% for s in arraysIdsAlbarane %}
                                {{ s.service_name }}
                                {% endfor %}

                                Contenedor: {{ arraysIdsAlbarane.container_residue  }}
                                {{ arraysIdsAlbarane.cubic_meters }}

                            </td>

                            <td scope="col" class=" text-center text-black"
                                style="font-size:0.8rem !important;background:none !important;">

                                {{ arraysIdsAlbarane.container_price }}

                            </td>
                            <td scope="col" class=" text-center text-black"
                                style="border-bottom:1px solid #dfdfdf87 !important;font-size:0.8rem !important;background:none !important;">

                                {% if ( arraysIdsAlbarane.discount != 0) %}
                                {{ arraysIdsAlbarane.discount }}
                                {% endif %}

                            </td>

                            <td scope="col" class=" text-center text-black"
                                style="border-bottom:1px solid #dfdfdf87 !important;font-size:0.8rem !important;background:none !important;">

                                {% if ( arraysIdsAlbarane.price_discount != null ) %}
                                {{ arraysIdsAlbarane.price_discount }}
                                {% endif %}

                            </td>

                            <td scope="col" class=" text-center text-black"
                                style="border-bottom:1px solid #dfdfdf87 !important;font-size:0.8rem !important;background:none !important;">

                                {% if ( arraysIdsAlbarane.tax_base != null ) %}
                                {{ arraysIdsAlbarane.amount_tax_base_discount }}
                                {% endif %}

                            </td>

                        </tr>

                        {#-----fin contendores------ #}

                        {#-----suplemento dentro albaranes ------ #}

                        {% for supplements in arraysIdsAlbarane.supplementsObject %}
                        <tr>

                            <td scope="col" class=" text-center text-black"
                                style="border-bottom:1px solid #dfdfdf87 !important;font-size:0.8rem !important;background:none !important;">
                                {% for s in arraysIdsAlbarane %}
                                {{ s.service_code }}
                                {% endfor %}
                            </td>

                            <td scope="col" class=" text-center text-black"
                                style="border-bottom:1px solid #dfdfdf87 !important;font-size:0.8rem !important;background:none !important;">
                                1
                            </td>

                            <td scope="col" class=" text-center text-black"
                                style="border-bottom:1px solid #dfdfdf87 !important;font-size:0.8rem !important;background:none !important;">

                                <u>
                                    {{ supplements.name }}</u>
                                <br>

                            </td>

                            <td scope="col" class=" text-center text-black"
                                style="border-bottom:1px solid #dfdfdf87 !important;font-size:0.8rem !important;background:none !important;">

                                {% if ( supplements.pvp_edit != null ) %}

                                {{ supplements.pvp_edit }}

                                {% endif %}

                            </td>

                            <td scope="col" class=" text-center text-black"
                                style="border-bottom:1px solid #dfdfdf87 !important;font-size:0.8rem !important;background:none !important;">

                                {% if ( supplements.dto !=  0) %}
                                {{ supplements.dto }}
                                {% endif %}

                            </td>

                            <td scope="col" class=" text-center text-black"
                                style="border-bottom:1px solid #dfdfdf87 !important;font-size:0.8rem !important;background:none !important;">

                                {% if ( supplements.price_dto !=  0) %}
                                {{ supplements.price_dto }}
                                {% endif %}

                            </td>

                            <td scope="col" class=" text-center text-black"
                                style="border-bottom:1px solid #dfdfdf87 !important;font-size:0.8rem !important;background:none !important;">

                                {% if ( supplements.total_price_supp != null or total_price_supp != 0) %}

                                {{ supplements.total_price_supp }}

                                {% endif %}
                            </td>
                        </tr>
                        {% endfor %}

                        {% endif %}
                        {% endfor %}

                        </tr>

                    </tbody>

                    {# {% if ( suppl_editional_existe == true ) %} #}
                    {% for supplementsAditional in supplements_obj_array %}

                    <tr>

                        <td class="td_supp text-center text-black"
                            style="font-size:0.8rem !important;background:none !important;"></td>

                        <td scope="col" class=" text-center text-black"
                            style="font-size:0.8rem !important;background:none !important;">
                            1</td>

                        <td scope="col" class=" text-center text-black"
                            style="font-size:0.8rem !important;background:none !important;">
                            Suplemento adicional al Albaran<br>
                            {% for supplements_obj in supplementsAditional.supplementsObjectAditional %}
                            {{ supplements_obj.name }}
                            {% endfor %}
                        </td>

                        <td scope="col" class=" text-center text-black"
                            style="font-size:0.8rem !important;background:none !important;">
                            {% for supplements_obj in supplementsAditional.supplementsObjectAditional %}
                            {{ supplements_obj.pvp_edit }}
                            {% endfor %}
                        </td>

                        <td scope="col" class=" text-center text-black"
                            style="font-size:0.8rem !important;background:none !important;">
                            {% for supplements_obj in supplementsAditional.supplementsObjectAditional %}
                            {% if ( supplements_obj.dto != 0) %}
                            {{ supplements_obj.dto }}
                            {% endif %}
                            {% endfor %}
                        </td>
                        <td scope="col" class=" text-center text-black"
                            style="font-size:0.8rem !important;background:none !important;">
                            {% for supplements_obj in supplementsAditional.supplementsObjectAditional %}
                            {% if ( supplements_obj.price_dto !=  0) %}
                            {{ supplements_obj.price_dto }}
                            {% endif %}
                            {% endfor %}
                        </td>

                        <td scope="col" class=" text-center text-black"
                            style="font-size:0.8rem !important;background:none !important;">

                            {% for supplements_obj in supplementsAditional.supplementsObjectAditional %}
                            {% if ( supplements_obj.price_total !=  0) %}
                            {{ supplements_obj.price_total }}
                            {% endif %}
                            {% endfor %}

                        </td>

                    </tr>
                    {% endfor %}
                    {# {% endif %} #}

                    </tbody>

                </table>

            </div>

            <div class="row justify-content-center">

                <table class="table table-striped table-borderless tabla" style="padding:5px !important;">

                    <thead style="background-color:#4d8f24;padding:5px !important;" class="text-white ">
                        <tr>
                            <th scope="col" class="text-center" style="font-size:0.8rem !important;">Total Bruto
                            </th>
                            <th scope="col" class="text-center" style="font-size:0.8rem !important;">Suma Dtos.</th>
                            <th scope="col" class="text-center" style="font-size:0.8rem !important;">
                                % Dto. Com.</th>
                            <th scope="col" class="text-center" style="font-size:0.8rem !important;">
                                % Dto. P.P</th>

                            <th scope="col" class="text-center" style="font-size:0.8rem !important;">BASE IMPONIBLE</th>
                            <th scope="col" class="text-center" style="font-size:0.8rem !important;">% I.R.P.F.</th>

                            <th scope="col" class="text-center" style="font-size:0.8rem !important;">% I.V.A.</th>
                            <th scope="col" class="text-center" style="font-size:0.8rem !important;">Cuota</th>
                            <th scope="col" class="text-center" style="font-size:0.8rem !important;">TOTAL</th>

                        </tr>
                    </thead>

                    <tbody>

                        <tr>

                            <th scope="col" class="text-center"
                                style="font-size:0.8rem !important;background:none !important;">
                                {{ gross_total }}
                            </th>

                            <th scope="col" class=" text-center"
                                style="font-size:0.8rem !important;background:none !important;">
                                {{total_dtos}}</th>

                            <th scope="col" class=" text-center"
                                style="font-size:0.8rem !important;background:none !important;">
                                -</th>

                            <th scope="col" class=" text-center"
                                style="font-size:0.8rem !important;background:none !important;">
                                -
                            </th>

                            <th scope="col" class=" text-center"
                                style="font-size:0.8rem !important;background:none !important;">
                                {{ taxable_base }}</th>

                            <th scope="col" class=" text-center"
                                style="font-size:0.8rem !important;background:none !important;">
                                -
                            </th>

                            <th scope="col" class=" text-center"
                                style="font-size:0.8rem !important;background:none !important;">
                                {{ iva }}</th>

                            <th scope="col" class=" text-center"
                                style="font-size:0.8rem !important;background:none !important;">
                                {{cuota}}
                            </th>
                            <th scope="col" class=" text-center"
                                style="font-size:0.8rem !important;background:none !important;">
                                {{total_con_iva}}</th>

                        </tr>

                    </tbody>

                </table>

            </div>

            <div class="row justify-content-center">

                <table class="table table-striped table-borderless tabla">

                    <thead style="color:#4d8f24;">
                        <tr>
                            <th scope="col" class="" style="font-size:0.8rem !important;background:none !important;">
                                &nbsp;&nbsp;Anticipo:
                            </th>
                            <th scope="col" class="text-black"
                                style="font-size:0.8rem !important;background:none !important;">
                                &nbsp;&nbsp;{{retainer_amount}}</th>

                            <th scope="col" class="" style="font-size:0.8rem !important;background:none !important;">
                                &nbsp;&nbsp;Cargos:</th>
                            <th scope="col" class="text-black"
                                style="font-size:0.8rem !important;background:none !important;">
                                &nbsp;&nbsp;{{cargos}}</th>
                            <th scope="col" class="" style="font-size:0.8rem !important;background:none !important;">
                                &nbsp;&nbsp; Saldo:</th>
                            <th scope="col" class="text-black"
                                style="font-size:0.8rem !important;background:none !important;">&nbsp;&nbsp;{{saldos}}
                            </th>

                            <th scope="col" class="text-white"
                                style="font-size:0.8rem !important;color:#4d8f24;background-color:#4d8f24;">
                                &nbsp;&nbsp; TOTAL FACTURA</th>
                            <th scope="col" class="text-white"
                                style="font-size:0.8rem !important;color:#4d8f24;background-color:#4d8f24;">
                                &nbsp;&nbsp;{{cargos}}
                                EUROS</th>

                        </tr>
                    </thead>

                </table>

            </div>

            <div class="row justify-content-center p-0">

                <div class="col-sm-6 p-0">

                    <div class="row">
                        <div class="col-sm-6 pl-3" style="color:#4d8f24;font-size:0.8rem !important;">&nbsp;&nbsp;Forma
                            de Pago</div>
                        <div class="col-sm-6 p-0" style="font-size:0.8rem !important;">
                            &nbsp;&nbsp;{{payment_method}}
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-6 pl-3" style="color:#4d8f24;font-size:0.8rem !important;">
                            &nbsp;&nbsp;Domiciliación</div>
                        <div class="col-sm-6 p-0" style="font-size:0.8rem !important;">
                            &nbsp;
                            {% for c in customers %}
                            {{ c.iban}}
                            {{ c.bank}}
                            {{ c.office_bank}}
                            {{ c.digital_control}}
                            {{ bank_count}}
                            {% endfor %}
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-6 pl-3" style="color:#4d8f24;font-size:0.8rem !important;">
                            &nbsp;&nbsp;Vencimientos</div>
                        <div class="col-sm-6 p-0" style="font-size:0.8rem !important;">
                            {% for bill in bills %}
                            &nbsp;&nbsp;{{ bill.expiration_date | date('d/m/y')}}
                            {% endfor %}
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-6 pl-3" style="color:#4d8f24;font-size:0.8rem !important;">
                            &nbsp;&nbsp;Importes</div>
                        <div class="col-sm-6 p-0" style="font-size:0.8rem !important;">&nbsp;&nbsp;{{cargos}}</div>
                    </div>

                </div>

                <div class="col-6"></div>

            </div>
            <hr>

        </div>
    </div>

</div>

{% endblock %}{% block script %}
{{parent(script)}}
<script>
    setTimeout(function() {
        $(".alerta_msg_albaranes").fadeOut(2000);
    }, 2200);

    function cambiarRutaCreaFactura() {
        var modal = document.getElementById("exampleModal");
        var modalBackdrop = document.getElementsByClassName("modal-backdrop")[0];
        modal.style.display = "none";
        modalBackdrop.style.display = "none";
        var form = document.getElementById('mi-formulario');
        form.setAttribute('action', '{{ baseUrl('
            createSaveBills ') }}');
    }
</script>
<script src="https://cdn.lordicon.com/qjzruarw.js"></script>{% endblock %}
